<!-- Single Invite Card with Selection -->
<div class="invite-card bg-base-100 shadow-xl rounded-lg p-6 hover:shadow-2xl transition-shadow duration-300 cursor-pointer relative" data-invite-id="{{ invite.id }}">
    <!-- Selection Checkbox -->
    <div class="absolute top-4 left-4 z-10">
        <input type="checkbox" class="invite-checkbox checkbox checkbox-primary" value="{{ invite.id }}" onclick="event.stopPropagation();">
    </div>
    
    <!-- Clickable area for selection (everything except buttons) -->
    <div class="invite-card-clickable pl-8">
        <!-- Invite Status Badge -->
        <div class="flex justify-between items-start mb-4">
            <div class="flex items-center space-x-2">
                {% if invite.is_active %}
                    {% if invite.expires_at and invite.expires_at < now %}
                        <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-yellow-500/10 text-yellow-400 border border-yellow-500/20">
                            <i class="fa-solid fa-clock w-3 h-3"></i>
                            Expired
                        </span>
                    {% elif invite.max_uses and invite.current_uses >= invite.max_uses %}
                        <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-red-500/10 text-red-400 border border-red-500/20">
                            <i class="fa-solid fa-users-slash w-3 h-3"></i>
                            Used Up
                        </span>
                    {% else %}
                        <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-green-500/10 text-green-400 border border-green-500/20">
                            <i class="fa-solid fa-check-circle w-3 h-3"></i>
                            Active
                        </span>
                    {% endif %}
                {% else %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-gray-500/10 text-gray-400 border border-gray-500/20">
                        <i class="fa-solid fa-pause-circle w-3 h-3"></i>
                        Inactive
                    </span>
                {% endif %}
                
                {% if invite.custom_path %}
                    <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-blue-500/10 text-blue-400 border border-blue-500/20">
                        <i class="fa-solid fa-link w-3 h-3"></i>
                        Custom Path
                    </span>
                {% endif %}
            </div>
            
            <!-- Action Buttons (non-clickable for selection) -->
            <div class="flex space-x-2" onclick="event.stopPropagation();">
                <button class="btn btn-sm btn-ghost" 
                        hx-get="{{ url_for('invites.view_invite_usages', invite_id=invite.id) }}"
                        hx-target="#usage-modal-content"
                        onclick="usage_modal.showModal()"
                        title="View Usage">
                    <i class="fa-solid fa-chart-line"></i>
                </button>
                
                <button class="btn btn-sm btn-ghost" 
                        hx-get="{{ url_for('invites.edit_invite', invite_id=invite.id) }}"
                        hx-target="#edit-invite-modal-content"
                        onclick="edit_invite_modal.showModal()"
                        title="Edit">
                    <i class="fa-solid fa-edit"></i>
                </button>
                
                <button class="btn btn-sm btn-error" 
                        hx-delete="{{ url_for('invites.delete_invite', invite_id=invite.id) }}"
                        hx-confirm="Are you sure you want to delete this invite?"
                        hx-target="#invite-list-content"
                        hx-swap="innerHTML"
                        title="Delete">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>
        </div>

        <!-- Invite Details -->
        <div class="space-y-3">
            <!-- Invite Link -->
            <div>
                <label class="text-sm font-medium text-base-content/70">Invite Link:</label>
                <div class="flex items-center space-x-2 mt-1">
                    {% if invite.custom_path %}
                        <code class="bg-base-200 px-2 py-1 rounded text-sm flex-1">{{ request.url_root }}invite/{{ invite.custom_path }}</code>
                    {% else %}
                        <code class="bg-base-200 px-2 py-1 rounded text-sm flex-1">{{ request.url_root }}invite/{{ invite.token }}</code>
                    {% endif %}
                    <button class="btn btn-xs btn-ghost" 
                            onclick="event.stopPropagation(); copyToClipboard('{% if invite.custom_path %}{{ request.url_root }}invite/{{ invite.custom_path }}{% else %}{{ request.url_root }}invite/{{ invite.token }}{% endif %}')"
                            title="Copy Link">
                        <i class="fa-solid fa-copy"></i>
                    </button>
                </div>
            </div>

            <!-- Usage Information -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-sm font-medium text-base-content/70">Uses:</label>
                    <p class="text-sm">
                        {{ invite.current_uses }}{% if invite.max_uses %} / {{ invite.max_uses }}{% else %} / âˆž{% endif %}
                    </p>
                </div>
                
                <div>
                    <label class="text-sm font-medium text-base-content/70">Expires:</label>
                    <p class="text-sm">
                        {% if invite.expires_at %}
                            {{ invite.expires_at.strftime('%Y-%m-%d %H:%M') }}
                        {% else %}
                            Never
                        {% endif %}
                    </p>
                </div>
            </div>

            <!-- Created Information -->
            <div>
                <label class="text-sm font-medium text-base-content/70">Created:</label>
                <p class="text-sm">{{ invite.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
            </div>

            <!-- Server Access -->
            {% if invite.invite_servers %}
            <div>
                <label class="text-sm font-medium text-base-content/70">Server Access:</label>
                <div class="flex flex-wrap gap-1 mt-1">
                    {% for invite_server in invite.invite_servers %}
                        {% set server = invite_server.server %}
                        {% if server.service_type.value == 'plex' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-plex-500/10 text-plex-400 border border-plex-500/20">
                                <svg class="w-3 h-3" viewBox="0 0 192 192" xmlns="http://www.w3.org/2000/svg" fill="currentColor" stroke="transparent" stroke-linejoin="round" stroke-width="12"><path d="M22 25.5h48L116 94l-46 68.5H22L68.5 94Zm109.8 56L108 46l14-20.5h48zm-.3 23.5c10.979 17.625 25.52 38.875 38.5 49.5-11.149 13.635-34.323 32.278-62.5-14z"/></svg>
                                {{ server.name }}
                            </span>
                        {% elif server.service_type.value == 'jellyfin' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-jellyfin-500/10 text-jellyfin-400 border border-jellyfin-500/20">
                                <i class="fa-solid fa-cube w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% elif server.service_type.value == 'emby' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-emby-500/10 text-emby-400 border border-emby-500/20">
                                <i class="fa-solid fa-play-circle w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% elif server.service_type.value == 'audiobookshelf' %>
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-audiobookshelf-500/10 text-audiobookshelf-400 border border-audiobookshelf-500/20">
                                <i class="fa-solid fa-headphones w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% elif server.service_type.value == 'kavita' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-kavita-500/10 text-kavita-400 border border-kavita-500/20">
                                <i class="fa-solid fa-book w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% elif server.service_type.value == 'komga' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-komga-500/10 text-komga-400 border border-komga-500/20">
                                <i class="fa-solid fa-book-open w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% elif server.service_type.value == 'romm' %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-romm-500/10 text-romm-400 border border-romm-500/20">
                                <i class="fa-solid fa-gamepad w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% else %}
                            <span class="inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-md bg-gray-500/10 text-gray-400 border border-gray-500/20">
                                <i class="fa-solid fa-server w-3 h-3"></i>
                                {{ server.name }}
                            </span>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Role Assignment -->
            {% if invite.role %}
            <div>
                <label class="text-sm font-medium text-base-content/70">Assigned Role:</label>
                <span class="badge badge-primary badge-sm">{{ invite.role.name }}</span>
            </div>
            {% endif %}

            <!-- Discord Guild Requirement -->
            {% if invite.force_guild_membership is not none %}
            <div>
                <label class="text-sm font-medium text-base-content/70">Discord Guild Required:</label>
                <span class="badge badge-{{ 'success' if invite.force_guild_membership else 'neutral' }} badge-sm">
                    {{ 'Yes' if invite.force_guild_membership else 'No' }}
                </span>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(function() {
        // You could add a toast notification here
        console.log('Copied to clipboard: ' + text);
    }, function(err) {
        console.error('Could not copy text: ', err);
    });
}
</script>
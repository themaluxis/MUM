<!-- Plex Authentication Step -->
<div class="step-section bg-base-200/30 border border-base-300 rounded-lg p-6" id="plex-step">
    <!-- Step Header -->
    <div class="flex items-center gap-3 mb-6">
        <div class="w-10 h-10 rounded-full bg-[#e5a00d]/20 flex items-center justify-center flex-shrink-0">
            <i class="fa-solid fa-right-to-bracket text-[#e5a00d] text-lg"></i>
        </div>
        <div>
            <h2 class="text-xl font-semibold text-base-content mb-1">Plex Authentication</h2>
            <p class="text-sm text-base-content/70">
                Sign in with your Plex account to access media servers
            </p>
        </div>
    </div>
    
    {% if already_authenticated_discord_user %}
        <div class="bg-[#5865F2]/10 border border-[#5865F2]/20 rounded-lg p-4 mb-6">
            <div class="flex items-start gap-3">
                <div class="w-6 h-6 rounded-full bg-[#5865F2]/20 flex items-center justify-center flex-shrink-0 mt-0.5">
                    <i class="fa-brands fa-discord text-[#5865F2] text-xs"></i>
                </div>
                <div>
                    <h4 class="font-medium text-[#5865F2] mb-1">Discord Account Connected</h4>
                    <p class="text-sm text-base-content/80">
                        Linked as <strong class="text-base-content">{{ already_authenticated_discord_user.username }}</strong>
                    </p>
                </div>
            </div>
        </div>
    {% endif %}

    <form method="POST" action="{{ url_for('invites.process_invite_form', invite_path_or_token=invite_path_or_token) }}">
        {{ form.hidden_tag() }}
        <button name="auth_method" value="plex" type="submit" 
                class="btn bg-[#e5a00d] hover:bg-[#c4880b] border-[#e5a00d] hover:border-[#c4880b] text-black w-full h-12 text-base font-medium">
            <i class="fa-solid fa-right-to-bracket mr-2"></i>
            Sign In with Plex
        </button>
    </form>
</div>
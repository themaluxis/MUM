<!-- File: app/templates/user/partials/security_tab.html -->
<div class="space-y-6">
    <!-- Security Overview Cards -->
    <div class="grid grid-cols-1 gap-4 mb-8">
        <!-- Last Login Card -->
        <div class="card bg-base-100 shadow-lg border border-base-300">
            <div class="card-body p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-sm font-medium text-base-content/70">Last Login</h3>
                        <p class="text-lg font-bold mt-1 text-base-content">
                            {% if user.last_login_at %}
                                {{ user.last_login_at.strftime('%b %d, %Y') }}
                            {% else %}
                                Never
                            {% endif %}
                        </p>
                        {% if user.last_login_at %}
                            <p class="text-xs text-base-content/50 mt-1">
                                {{ user.last_login_at.strftime('%I:%M %p') }}
                            </p>
                        {% endif %}
                    </div>
                    <div class="p-3 rounded-full bg-primary/10">
                        <i class="fa-solid fa-clock text-2xl text-primary"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Management Section -->
    <div class="card bg-base-100 shadow-lg border border-base-300">
        <div class="card-header">
            <div class="flex items-center justify-between p-6 border-b border-base-300">
                <div class="flex items-center gap-3">
                    <div class="p-2 rounded-lg bg-error/10">
                        <i class="fa-solid fa-key text-lg text-error"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold text-base-content">Password Management</h2>
                        <p class="text-sm text-base-content/70">Manage your account password and security settings</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-body p-6">
            {% if user.password_hash %}
                <div class="alert alert-success mb-6">
                    <i class="fa-solid fa-check-circle"></i>
                    <div>
                        <h3 class="font-bold">Password Protection Active</h3>
                        <div class="text-xs">Your account is protected with a secure password. You can reset it anytime if needed.</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between p-6 bg-base-200 rounded-xl">
                    <div class="flex items-center gap-4">
                        <div class="p-3 rounded-full bg-warning/10">
                            <i class="fa-solid fa-key text-xl text-warning"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-base-content">Reset Password</h3>
                            <p class="text-sm text-base-content/70">Generate a new secure password for this account</p>
                            <div class="flex items-center gap-2 mt-2">
                                <i class="fa-solid fa-info-circle text-xs text-info"></i>
                                <span class="text-xs text-base-content/60">This will require you to log in again</span>
                            </div>
                        </div>
                    </div>
                    <button 
                        class="btn btn-warning btn-outline"
                        hx-get="{{ url_for('user.reset_app_user_password', username=user.username) }}"
                        hx-target="#user_reset_password_modal_content"
                        hx-swap="innerHTML"
                        onclick="document.getElementById('user_reset_password_modal').showModal()"
                        title="Reset user password"
                    >
                        <i class="fa-solid fa-key mr-2"></i>
                        Reset Password
                    </button>
                </div>
            {% else %}
                <div class="alert alert-warning mb-6">
                    <i class="fa-solid fa-exclamation-triangle"></i>
                    <div>
                        <h3 class="font-bold">No Password Set</h3>
                        <div class="text-xs">This account doesn't have a password. Consider setting one for better security.</div>
                    </div>
                </div>
                
                <div class="flex items-center justify-between p-6 bg-base-200 rounded-xl opacity-50">
                    <div class="flex items-center gap-4">
                        <div class="p-3 rounded-full bg-base-300">
                            <i class="fa-solid fa-key text-xl text-base-content/50"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-base-content/70">Set Password</h3>
                            <p class="text-sm text-base-content/50">Password management is only available for accounts with passwords</p>
                        </div>
                    </div>
                    <button class="btn btn-disabled" disabled>
                        <i class="fa-solid fa-ban mr-2"></i>
                        Not Available
                    </button>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Account Information Section -->
    <div class="card bg-base-100 shadow-lg border border-base-300">
        <div class="card-header">
            <div class="flex items-center justify-between p-6 border-b border-base-300">
                <div class="flex items-center gap-3">
                    <div class="p-2 rounded-lg bg-info/10">
                        <i class="fa-solid fa-user-shield text-lg text-info"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-semibold text-base-content">Account Information</h2>
                        <p class="text-sm text-base-content/70">View your account details and security status</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-body p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Account Details -->
                <div class="space-y-4">
                    <h3 class="font-semibold text-base-content border-b border-base-300 pb-2">Account Details</h3>
                    
                    <div class="space-y-3">
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-user text-sm"></i>
                                Username
                            </span>
                            <span class="font-medium text-base-content">{{ user.username }}</span>
                        </div>
                        
                        {% if user.email %}
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-envelope text-sm"></i>
                                Email
                            </span>
                            <span class="font-medium text-base-content">{{ user.email }}</span>
                        </div>
                        {% endif %}
                        
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-calendar-plus text-sm"></i>
                                Created
                            </span>
                            <span class="font-medium text-base-content">
                                {{ user.created_at.strftime('%b %d, %Y') if user.created_at else 'Unknown' }}
                            </span>
                        </div>
                        
                        {% if user.updated_at %}
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-clock-rotate-left text-sm"></i>
                                Last Updated
                            </span>
                            <span class="font-medium text-base-content">
                                {{ user.updated_at.strftime('%b %d, %Y') }}
                            </span>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Security Status -->
                <div class="space-y-4">
                    <h3 class="font-semibold text-base-content border-b border-base-300 pb-2">Security Status</h3>
                    
                    <div class="space-y-3">
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-shield-halved text-sm"></i>
                                Password Protection
                            </span>
                            {% if user.password_hash %}
                                <span class="badge badge-success gap-2">
                                    <i class="fa-solid fa-check text-xs"></i>
                                    Enabled
                                </span>
                            {% else %}
                                <span class="badge badge-warning gap-2">
                                    <i class="fa-solid fa-exclamation text-xs"></i>
                                    Disabled
                                </span>
                            {% endif %}
                        </div>
                        
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-mobile-screen text-sm"></i>
                                Two-Factor Authentication
                            </span>
                            <span class="badge badge-ghost gap-2">
                                <i class="fa-solid fa-minus text-xs"></i>
                                Not Available
                            </span>
                        </div>
                        
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-chart-line text-sm"></i>
                                Login Tracking
                            </span>
                            <span class="badge badge-ghost gap-2">
                                <i class="fa-solid fa-minus text-xs"></i>
                                Basic
                            </span>
                        </div>
                        
                        {% if user.used_invite_id %}
                        <div class="flex items-center justify-between py-2">
                            <span class="text-base-content/70 flex items-center gap-2">
                                <i class="fa-solid fa-ticket text-sm"></i>
                                Created via Invite
                            </span>
                            <span class="font-medium text-base-content">#{{ user.used_invite_id }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
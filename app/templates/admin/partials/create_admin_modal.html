{# This partial template is rendered inside the "Create Admin" modal. #}
{# It expects 'form' (AdminCreateForm) in the context. #}

<!-- Info Card -->
<div class="bg-base-200/50 rounded-lg p-4 mb-6 border border-base-300">
    <div class="flex items-start gap-3">
        <div class="w-8 h-8 rounded-full bg-info/20 flex items-center justify-center flex-shrink-0 mt-0.5">
            <i class="fa-solid fa-info text-info text-sm"></i>
        </div>
        <div>
            <h4 class="font-medium text-base-content mb-1">Administrator Account</h4>
            <p class="text-sm text-base-content/70 leading-relaxed">
                Create a new administrator account with full system access. The new admin will be required to change their password on first login for security.
            </p>
        </div>
    </div>
</div>

<form id="createAdminForm"
      hx-post="{{ url_for('admin_management.create') }}"
      hx-target="this"
      hx-swap="outerHTML"
      hx-indicator="#create_admin_loader"
      hx-on::after-request="if(event.detail.successful) { document.getElementById('create_admin_modal').close(); this.reset(); }">
              
    {{ form.hidden_tag() }}
    
    <!-- Account Details Section -->
    <div class="space-y-4 mb-6">
        <h4 class="font-medium text-base-content text-lg mb-3">
            <i class="fa-solid fa-user text-success text-sm mr-2"></i>
            Account Details
        </h4>
        
        <!-- Username Field -->
        <div class="bg-base-200/30 rounded-lg p-4 border border-base-300 hover:border-base-300 transition-colors">
            <div class="flex items-center gap-2 mb-2">
                <i class="fa-solid fa-user text-success text-sm"></i>
                <h5 class="font-medium text-base-content">{{ form.username.label.text }}</h5>
            </div>
            {{ form.username(class="input input-bordered w-full " + ("input-error" if form.username.errors else "")) }}
            {% if form.username.errors %}
                {% for e in form.username.errors %}
                    <p class="text-error text-xs mt-2">{{e}}</p>
                {% endfor %}
            {% else %}
                <p class="text-xs text-base-content/60 mt-2">Choose a unique username for the administrator account</p>
            {% endif %}
        </div>
    </div>

    <!-- Security Section -->
    <div class="space-y-4 mb-6">
        <h4 class="font-medium text-base-content text-lg mb-3">
            <i class="fa-solid fa-shield-halved text-warning text-sm mr-2"></i>
            Security Settings
        </h4>
        
        <!-- Password Field -->
        <div class="bg-base-200/30 rounded-lg p-4 border border-base-300 hover:border-base-300 transition-colors">
            <div class="flex items-center gap-2 mb-2">
                <i class="fa-solid fa-lock text-warning text-sm"></i>
                <h5 class="font-medium text-base-content">{{ form.password.label.text }}</h5>
            </div>
            {{ form.password(class="input input-bordered w-full " + ("input-error" if form.password.errors else "")) }}
            {% if form.password.errors %}
                {% for e in form.password.errors %}
                    <p class="text-error text-xs mt-2">{{e}}</p>
                {% endfor %}
            {% else %}
                <p class="text-xs text-base-content/60 mt-2">Create a temporary password (minimum 8 characters)</p>
            {% endif %}
        </div>

        <!-- Confirm Password Field -->
        <div class="bg-base-200/30 rounded-lg p-4 border border-base-300 hover:border-base-300 transition-colors">
            <div class="flex items-center gap-2 mb-2">
                <i class="fa-solid fa-lock text-warning text-sm"></i>
                <h5 class="font-medium text-base-content">{{ form.confirm_password.label.text }}</h5>
            </div>
            {{ form.confirm_password(class="input input-bordered w-full " + ("input-error" if form.confirm_password.errors else "")) }}
            {% if form.confirm_password.errors %}
                {% for e in form.confirm_password.errors %}
                    <p class="text-error text-xs mt-2">{{e}}</p>
                {% endfor %}
            {% else %}
                <p class="text-xs text-base-content/60 mt-2">Re-enter the password to confirm</p>
            {% endif %}
        </div>

        <!-- Security Notice -->
        <div class="bg-warning/10 rounded-lg p-3 border border-warning/30">
            <div class="flex items-start gap-2">
                <i class="fa-solid fa-exclamation-triangle text-warning text-sm mt-0.5"></i>
                <p class="text-sm text-base-content/80">
                    <strong>Security Notice:</strong> The new administrator will be required to change this temporary password on their first login.
                </p>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex items-center justify-end gap-3 mt-8 pt-6 border-t border-base-300">
        <button type="button" class="btn btn-ghost" onclick="create_admin_modal.close()">
            Cancel
        </button>
        <button type="submit" class="btn btn-success gap-2">
            <span id="create_admin_loader" class="htmx-indicator loading loading-spinner loading-xs"></span>
            <i class="fa-solid fa-user-plus"></i>
            Create Admin
        </button>
    </div>
</form>
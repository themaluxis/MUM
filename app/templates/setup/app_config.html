{% extends "layouts/setup.html" %}

{% block title %}App Configuration - {{ g.app_name }} Setup{% endblock %}

{% block setup_content %}
<div class="card bg-base-200 shadow-xl max-w-4xl mx-auto">
    <div class="card-body">
        <!-- Navigation -->
        <div class="flex items-center mb-8">
            <a href="{{ url_for('setup.plugins') }}" class="btn btn-ghost btn-sm">
                <i class="fa-solid fa-arrow-left mr-2"></i> Back to Services
            </a>
        </div>

        <!-- Clean Header -->
        <div class="mb-4">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0">
                    <i class="fa-solid fa-sliders text-primary text-lg"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-base-content mb-1">App Configuration</h1>
                    <p class="text-sm text-base-content/70">Configure your application's core settings and identity</p>
                </div>
            </div>
        </div>

        <form method="POST" action="{{ url_for('setup.app_config') }}">
            {{ form.hidden_tag() }}
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            
            <div class="space-y-6">
                
                <!-- Application Identity Section -->
                <div class="bg-base-100 border border-base-300 rounded-lg p-6">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0">
                            <i class="fa-solid fa-id-card text-primary text-sm"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-base-content mb-1">Application Identity</h2>
                            <p class="text-sm text-base-content/70">Configure how your application appears to users</p>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- App Name -->
                        <div class="bg-base-200 rounded-lg p-4 border border-base-300 hover:border-base-300/60 transition-colors">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fa-solid fa-tag text-primary text-sm"></i>
                                <h5 class="font-medium text-base-content">{{ form.app_name.label.text }}</h5>
                            </div>
                            {{ form.app_name(class="input input-bordered w-full " + ("input-error" if form.app_name.errors else "")) }}
                            {% if form.app_name.errors %}
                                <p class="text-error text-xs mt-2">{{ form.app_name.errors[0] }}</p>
                            {% else %}
                                <p class="text-xs text-base-content/60 mt-2">The public name for this application</p>
                            {% endif %}
                        </div>

                        <!-- App Base URL -->
                        <div class="bg-base-200 rounded-lg p-4 border border-base-300 hover:border-base-300/60 transition-colors">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fa-solid fa-globe text-primary text-sm"></i>
                                <h5 class="font-medium text-base-content">{{ form.app_base_url.label.text }}</h5>
                            </div>
                            {{ form.app_base_url(class="input input-bordered w-full " + ("input-error" if form.app_base_url.errors else ""), placeholder="https://mum.example.com") }}
                            {% if form.app_base_url.errors %}
                                <p class="text-error text-xs mt-2">{{ form.app_base_url.errors[0] }}</p>
                            {% else %}
                                <p class="text-xs text-base-content/60 mt-2">{{ form.app_base_url.description }}</p>
                            {% endif %}
                        </div>

                        <!-- App Local URL -->
                        <div class="bg-base-200 rounded-lg p-4 border border-base-300 hover:border-base-300/60 transition-colors">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fa-solid fa-network-wired text-primary text-sm"></i>
                                <h5 class="font-medium text-base-content">{{ form.app_local_url.label.text }}</h5>
                            </div>
                            {{ form.app_local_url(class="input input-bordered w-full " + ("input-error" if form.app_local_url.errors else ""), placeholder="http://192.168.1.100:5000") }}
                            {% if form.app_local_url.errors %}
                                <p class="text-error text-xs mt-2">{{ form.app_local_url.errors[0] }}</p>
                            {% else %}
                                <p class="text-xs text-base-content/60 mt-2">{{ form.app_local_url.description }}</p>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- URL Configuration Info -->
                <div class="bg-info/10 border border-info/20 rounded-lg p-4">
                    <div class="flex items-start gap-3">
                        <div class="w-6 h-6 rounded-full bg-info/20 flex items-center justify-center flex-shrink-0 mt-0.5">
                            <i class="fa-solid fa-lightbulb text-info text-xs"></i>
                        </div>
                        <div>
                            <h4 class="font-medium text-info mb-1">URL Configuration</h4>
                            <div class="text-sm text-base-content/80 space-y-1">
                                <p><strong>Public URL:</strong> Required for external access, OAuth callbacks, and invite links</p>
                                <p><strong>Local URL:</strong> Optional for internal network access and faster local connections</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-between items-center pt-6 border-t border-base-300">
                    <a href="{{ url_for('setup.plugins') }}" class="btn btn-ghost h-11">
                        <i class="fas fa-arrow-left mr-2"></i>Back
                    </a>
                    {{ form.submit(class="btn btn-primary h-11") }}
                </div>
            </div>
        </form>
    </div>
</div>

{% endblock %}
